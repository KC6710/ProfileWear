{{ header }}
<style>
  /* Add styles for the selected size div and hidden range inputs */
.color-sec {
  /* ... Your existing styles ... */
}
.out-of-sale {
    margin: 30px 0 44px 0;
    background: #ffd5d5;
    padding: 22px 20px;
    font-size: 14px;
    font-weight: 600;
}

.color-sec.selected {
  /* Add styles for the selected size div */
  background-color: #32cd32; /* Example background color for the selected size */
  color: white; /* Example text color for the selected size */
}

.single_range_input {
  display: none; /* Hide range inputs initially */
}

.main-image{
  background: #f0f7f9;
  text-align: center;
  padding:15px 0;
  border-radius:15px;
}
img#main-prod-image{mix-blend-mode: darken;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    will-change: opacity;}
li.main-image   {margin-bottom:15px;}
</style>
<main class="main-body product-details-main">
  {{ menu }}
<div class="product-header">

    {% for breadcrumb in breadcrumbs %}
      
      {% if loop.last %}
        <p class="item">{{ breadcrumb.text }}</p>
      {% else %}
        <a href="{{ breadcrumb.href }}"><h6 class="item active">{{ breadcrumb.text }}</h6></a>
        <span class="bg-pink"></span>
      {% endif %}

    {% endfor %}
  </div>

  <div id="product-info" class="product-info">
    <div class="row gy-2">
      <div class="col-12 col-md-12 col-lg-6 p-2">
        {# {% if thumb or images %} #}
        {# <div class="image-div">
          <div class="image">
            <div id="carouselExampleIndicators0" class="carousel slide mobile pointer-event" data-bs-ride="carousel" data-bs-touch="true" data-bs-interval="150000">
              <div class="carousel-inner">
                {% if thumb %}
                  <div class="carousel-item active">
                    <img id="display_image" src="{{ thumb }}">
                  </div>
                {% endif %}
                {% for image in images %}
                  <div class="carousel-item">
                    <img src="{{ image.thumb }}">
                  </div>
                {% endfor %}
              </div>
            </div>
            {% if thumb %}
              <img class="web" id="bigImage" src="{{ thumb }}" style="transform-origin: center center; transform: scale(1);">
            {% endif %}
          </div>
          {% if images %}
            <div class="display">
              <button class="web" onclick="previousSlide('carousel0')">
                <img src="image/arrow-left.svg">
              </button>
              <div id="carousel0" class="carousel slide">
                <div class="carousel-inner">
                      {% for image in images %}

                        {% if loop.index == 1 or (loop.index - 1) % 5 == 0 %}
                          <div class="carousel-item {% if loop.index == 1 %}active{% endif %}">
                            <div class="carousel-inner-div" style="width: calc(100% / 5 )">
                              {% if loop.index == 1 and thumb %}
                                <div class="display-pic">
                                  <img src="{{ thumb }}" onclick="updateImage(this)" class="selected-image">
                                </div>
                              {% endif %}
                        {% endif %}
                        <div class="display-pic">
                          {% if loop.first and not thumb %}
                            <img src="{{ image.thumb }}" onclick="updateImage(this)" class="selected-image">
                          {% else %}
                            <img src="{{ image.thumb }}" onclick="updateImage(this)">
                          {% endif %}
                        </div>
                        {% if loop.index % 5 == 0 or loop.last %}
                            </div>
                          </div>
                        {% endif %}
                      {% endfor %}
                    </div>
                  </div>
              <button class="web" onclick="nextSlide('carousel0')" style="z-index:1000;">
                <img src="image/arrow-right.svg">
              </button>
            </div>
          {% endif %}
        </div> #}
        {# {% endif %} #}
        {% if thumb or images %}
          <ul class="thumbnails">
            {% if thumb %}
            <li class="main-image"><a class="thumbnail" href="{{ popup }}" title="{{ heading_title }}"><img id="main-prod-image"src="{{ thumb }}" title="{{ heading_title }}" alt="{{ heading_title }}" /></a></li>
            {% else %}
              <li class="main-image"><a class="thumbnail"><img src="https://profilewear.se/image/cache/placeholder-350x350.png" /></a></li>
            {% endif %}
          </ul>
          <div class="imagesItemsResized">
          <ul class="thumbnails">
            {% if images %}
            {% for image in images %}
            <li class="image-additional"><a class="thumbnail" href="{{ image.popup }}" title="{{ heading_title }}"> <img src="{{ image.thumb }}" title="{{ heading_title }}" alt="{{ heading_title }}" /></a></li>
            {% endfor %}
            {% endif %}
          </ul>
            {% if images|length > 5 %}
              <p class="imagesItemsResizedShadowOverlay" style="display: block;"></p>
            {% endif %}
        </div><!--imagesItemsResized-->
            {% if images|length > 5 %}
              <button class="imagesItemsResizeBtnCollapse imagesItemsMoreBtn">Visa fler bilder <i class="fas fa-chevron-down" style="margin-left: 3px;" aria-hidden="true"></i></button>
            {% endif %}

          {% endif %}
      </div>
      <div class="col-12 mobile">
        <div style="position: static" class="carousel-indicators mobile">
          {% if thumb %}
            <button type="button" data-bs-target="#carouselExampleIndicators0" data-bs-slide-to="1" aria-label="Slide 2"></button>
          {% endif %}
          {% for image in images %}
            <button type="button" data-bs-target="#carouselExampleIndicators0" data-bs-slide-to="1" aria-label="Slide 2"></button>
          {% endfor %}
        </div>
      </div>
      <div class="col-12 col-md-12 col-lg-6 p-2">
        <div class="content">
          <div class="header">
            <div class="d-flex justify-content-between align-items-start">
              <div class="topbtns">
              {% if tags %}
                  {% for i in 0..(tags|length - 1) %}
                    <p class="product-select">{{ tags[i].tag }}</p>
                  {% endfor %}
              {% endif %}
              </div>
              <form method="post" data-oc-toggle="ajax" data-oc-load="{{ cart }}" data-oc-target="#header-cart" class="wishlist-form">
                {% if  wishlist_data and product_id in wishlist_data|column('product_id') %}
                  <button type="submit" formaction="{{ remove }}" data-bs-toggle="tooltip" title="{{ button_remove }}" class="btn wishlist-button" data-remove_url="{{ remove }}" data-addwishlist_url="{{ add_to_wishlist }}"><img src="image/wishlist1.svg" alt="Remove from wishlist" /></button>
                {% else %}
                  <button type="submit" style="border: none;background: none;" formaction="{{ add_to_wishlist }}" data-bs-toggle="tooltip" title="{{ button_wishlist }}" class="btn wishlist-button" data-remove_url="{{ remove }}" data-addwishlist_url="{{ add_to_wishlist }}">
                    <img src="image/wishlist.svg" alt="Add to wishlist" />
                  </button>
                {% endif %}
                <input type="hidden" name="product_id" value="{{ product_id }}"/>
                <input type="hidden" name="quantity" value="{{ minimum }}"/>
          </form>
            </div>
            {% if manufacturer %}
              <h6>{{ text_manufacturer }} <a href="{{ manufacturers }}">{{ manufacturer }}</a></h6>
            {% endif %}
            <h3>{{ heading_title }}</h3>
            <p>{{ text_model }} {{ model }}</p>
            {% if stock != 'Utgått' %}
            {% if price %}
                {% if not special %}
                    <h5>{{ price }}</h5>
                {% else %}
                  <span class="price-old">{{ price }}</span>
                  <h5>{{ special }}</h5>
                {% endif %}
            {% endif %}
            {% endif %}
          </div>
          <div class="border-bottom"></div>
          {% if stock == 'Utgått' %}
            <div class="out-of-sale">
            Denna produkt säljs ej längre!<br>
            Du har tyvärr kommit till en produkt som inte längre finns i vårt sortiment.
            </div>
          {% else %}            
            <form id="form-product">
              {% set i = 1 %}
                {% for option in options %}
                  {% if option.name == 'Size' or 'Storlek' in option.name %}

                  <div class="category">
                    <div class="accordion accordion-flush" id="accordion{{ option.name }}" style="width: 100%">
                      <div class="accordion-item">
                        <div class="accordion-header">
                          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{ option.name }}" aria-expanded="true" aria-controls="flush-collapse{{ option.name }}" style="padding: 0;box-shadow: none;">
                            <div class="category-box">
                              <div class="numbering" id="numbering{{ option.name|replace({' ': ''}) }}">
                                <p>{{ i }}</p>
                              </div>
                              <div class="selection" id="tag{{ option.name|replace({' ': ''}) }}">
                                  <h3>{{ option.name }}</h3>
                                  <p>Välj önskad antal.</p>
                                  <div id="size_div" style="display:flex;">
                                      {% for option_name in option.product_option_value %}
                                      <h6 style="display:none;margin-right: 10px" class="option{{option_name.product_option_value_id}}">0 | {{option_name.name}}</h6>
                                      {% endfor %}
                                  </div>
                                </div>
                            </div>
                        </div>
                        <div style="margin-left: 30px;" id="flush-collapse{{ option.name }}" class="accordion-collapse collapse" data-bs-parent="#accordion{{ option.name }}">
                          <div class="accordion-body">
                            {#
                            <div class="quantity-selection">
                              <p>
                                <span>*</span> The minimum amount quantity
                                <span style="font-weight: 500; color: black">25pcs</span>
                              </p>
                              <p>
                                <span>* </span> Increase with 25pcs more and get
                                <span style="font-weight: 500; color: black">10% discount</span>
                              </p>
                            </div>
                            #}
                            <div class="size-selection">
                              {% for option_value in option.product_option_value %}
                                <div class="size-sec" onclick="selectSize({{ loop.index }});setQuantityValue('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}', {{ option_value.product_option_value_id }}, '{{ option_value.name }}', '{{loop.index}}')">
                                  <div>
                                    <div style="padding: 6px 10px; border-radius: 5px; border: 1px solid var(--stroke-gray); text-align: center;">
                                      <span>{{ option_value.name }}<span class="slash" style="margin-left: 10px;"> | </span><span style="margin-left: 5px;"><input type="number" class="quantity_input" onchange="selectSize({{ loop.index }});setQuantityValue('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}', {{ option_value.product_option_value_id }}, '{{ option_value.name }}', '{{loop.index}}')" oninput="handleSizeRangeChangeNew(event,{{ loop.index }})" min="0" max="100" id="quantityOne{{ loop.index }}" value="0" style="width: fit-content;border: none;text-align: center;"></span> <span id="sizeValueQ{{ loop.index }}"></span></span>
                                    </div>
                                    <div>
                                      <input type="range" class="single_range_input" oninput="handleSizeRangeChangeNew(event,{{ loop.index }})" min="0" max="100" id="rangeOne{{ loop.index }}" value="0">
                                      <input type="hidden" name="quantity_value_{{ option_value.product_option_value_id }}" id="quantity_value{{ option_value.product_option_value_id }}" value="0" data-main_product="{{product_id}}" data-product="{{product_id}}">
                                      <input type="hidden" name="size_value{{ option_value.product_option_value_id }}" id="size_value{{ option_value.product_option_value_id }}" value="{{option_value.product_option_value_id}}">
                                      <input type="hidden" name="option[{{ option.product_option_id }}][{{option_value.product_option_value_id}}]" id="input-option-{{ option.product_option_id }}-{{option_value.product_option_value_id}}">
                                    </div>
                                  </div>
                                </div>
                              {% endfor %}
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>
                    {# <input type="hidden" name="option[{{ option.product_option_id }}]" id="input-option-{{ option.product_option_id }}"> #}
                  </div>
                  <div id="error-option-{{ option.product_option_id }}" class="invalid-feedback d-block"></div>
                  <div id="error-quantity" class="invalid-feedback d-block"></div>
                  <div class="border-bottom"></div>
                  {% set i = i + 1 %}
                  {% elseif option.name == 'Color' or option.name == 'Delivery Type' or option.name == 'Print Method'  or 'Färg' in option.name %}

                  <div class="category" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight{{ option.name|replace({' ': ''}) }}" aria-controls="offcanvasRight{{ option.name|replace({' ': ''}) }}">
                    <div class="category-box">
                      <div class="numbering" id="numbering{{ option.name|replace({' ': ''}) }}">
                        <p>{{ i }}</p>
                      </div>
                      <div class="selection" id="tag{{ option.name|replace({' ': ''}) }}">
                        <h3>{{ option.name }}</h3>
                        <p>Välj färg på artikeln.</p>
                      </div>
                    </div>
                    <div class="arrow-icon">
                      <img src="image/arrow-right.svg">
                    </div>
                    <input type="hidden" name="option[{{ option.product_option_id }}]" id="input-option-{{ option.product_option_id }}" data-option-price="0">
                  </div>
                  <div id="error-option-{{ option.product_option_id }}" class="invalid-feedback d-block"></div>
                  <div class="border-bottom"></div>
                  {% set i = i + 1 %}
                  {% else %}
                    <input type="hidden" name="option[{{ option.product_option_id }}]" id="input-option-{{ option.product_option_id }}" data-option-price="0">
                  {% endif %}
                {% endfor %}

                <div class="category" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRightPrintOptions" aria-controls="offcanvasRightoffcanvasRightPrintOptions">
                  <div class="category-box">
                    <div class="numbering" id="numberingPrintOptions">
                      <p>{{ i }}</p>
                    </div>
                    <div class="selection" id="tagPrintOptions">
                      <h3>Tryck & profilering</h3>
                      <p>Lägg till tryck och profilering.</p>
                    </div>
                  </div>
                  <div class="arrow-icon">
                    <img src="image/arrow-right.svg">
                  </div>
                </div>
                <div class="border-bottom"></div>
              <div class="price-box">
                <div class="total-price">
                  <h5>Totalt pris</h5>
                  <h4>00.00</h4>
                </div>
                <div class="price-specification">
                  <h6>
                    Pris Specifikation <img src="image/arrow-right.svg">
                  </h6>
                  
                </div>
                {#
                <div class="notes mb-4">
                  <div class="d-flex align-items-center justify-content-start gap-2 my-2">
                    <img src="image/local-shipping.svg">
                    <p style="margin: 0" id="deliverytimediv">
                      Select Delivery Type for Estimation
                    </p>
                  </div>
                #}

                
                <div class="buttonBox d-flex justify-content-between align-items-center gap-3 mt-3">
                  <a class="outlinedButton px-5" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRightContact" aria-controls="offcanvasRightContact" style="width:48%;">
                    Kontakta oss<img src="image/arrow-right-green.svg">
                  </a>
                  <input type="hidden" name="quantity" value="" size="2" id="input-product-quantity" class="form-control"/> 
                  <input type="hidden" name="product_id" value="{{ product_id }}" id="input-product-id"/>
                  <input type="hidden" name="base_price" id="input-base-price" data-base-price="{{ price }}">
                  
                  <button type="submit" id="button-cart" class="primaryButton">{{ button_cart }}<img src="image/arrow-right.png"></button>
                </div>
              </div>
            </form>
          {% endif %}  
        </div>
      </div>
    </div>
    <div class="gap-div-30"></div>

    <div class="row gy-2">
      <div class="col-12 col-md-12 col-lg-6 p-2">
        <div class="product-tabs">
          <ul class="nav nav-tabs">
            <li class="nav-item"><a href="#tab-description" data-bs-toggle="tab" class="nav-link active">Prislista</a></li>
            {% if attribute_groups %}
              <li class="nav-item"><a href="#tab-specification" data-bs-toggle="tab" class="nav-link">{{ tab_attribute }}</a></li>
            {% endif %}
            <li class="nav-item"><a href="#tab-print-details" data-bs-toggle="tab" class="nav-link">Tryckdetaljer</a></li>
            <li class="nav-item"><a href="#tab-faq" data-bs-toggle="tab" class="nav-link">FAQ</a></li>
          </ul>
          <div class="tab-content">
          <div id="tab-description" class="tab-pane fade show active mb-4">
              <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                      <tr>
                        <td><strong>1-24st</strong></td>
                        <td><strong>25st</strong></td>
                        <td><strong>50st</strong></td>
                        <td><strong>100st</strong></td>
                      </tr>
                    </thead>    
                    <tbody>
                      <tr>
                        <td>0.00kr</td>
                        <td>0.00kr</td>
                        <td>0.00kr</td>
                        <td>0.00kr</td>
                      </tr>
                    </tbody>            
                </table>
              </div>          
          </div>
          {% if attribute_groups %}
            <div id="tab-specification" class="tab-pane mb-4">
            <h3 style="display : block; margin-bottom: undefined">Produktdetaljer</h3>
              <div class="table-responsive">
                <table class="table table-bordered">
                  {% for attribute_group in attribute_groups %}
                    <thead>
                      <tr>
                        <td colspan="2"><strong>{{ attribute_group.name }}</strong></td>
                      </tr>
                    </thead>
                    <tbody>
                      {% for attribute in attribute_group.attribute %}
                        <tr>
                          <td>{{ attribute.name }}</td>
                          <td>{{ attribute.text }}</td>
                        </tr>
                      {% endfor %}
                    </tbody>
                  {% endfor %}
                </table>
              </div>
            </div>
          {% endif %}
            <div id="tab-print-details" class="tab-pane fade mb-4">
              {# <h3 style="display : block;">Print Details</h3> #}
                {% set printTypeGroup = attribute_groups|filter(attribute_group => attribute_group.name|trim == 'Print Type')|first %}
                {% set printCodeGroup = attribute_groups|filter(attribute_group => attribute_group.name|trim == 'Print Code')|first %}

                {% for key, printMethod in pricesArray %}
                  <br>
                  <h3>{{ key }}</h3>
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Quantity</th>
                        {% for keycolor, ColorDetails in printMethod|slice(0, 1) %}
                          {% for keycolors, pricesColorDetails in ColorDetails %}
                            <td>{{ keycolors }}</td>
                          {% endfor %}
                        {% endfor %}
                      </tr>
                    </thead>
                    <tbody>
                      {% for keycolor, ColorDetails in printMethod %}
                        <tr>
                          <td>{{ keycolor }}</td>
                          {% for pricesColorDetails in ColorDetails %}
                            <td>{{ pricesColorDetails }}</td>
                          {% endfor %}
                        </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                {% endfor %}

            </div>
            <div id="tab-faq" class="tab-pane fade mb-4">
            <h3 style="display : block; margin-bottom: undefined">Mer information för dig</h3>
            <div class="accordion accordion-flush" id="accordionFlushExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                    T-shirts Med Tryck
                  </button>
                </h2>
                <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                    eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
                    enim ad minim veniam, quis nostrud exercitation ullamco laboris
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
                    in reprehenderit in voluptate velit esse cillum dolore eu fugiat
                    nulla pariatur. Excepteur sint occaecat cupidatat non proident,
                    sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                    Shirts with own print
                  </button>
                </h2>
                <div id="flush-collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body">
                    <p>
                      A shirt with a print can look many different ways, for
                      example, it can be a regular t-shirt, a stylish polo shirt or
                      a regular classic college shirt. In addition, you can choose
                      between different materials for your printed sweaters, such as
                      cotton in sweatshirts or polyester in fleece sweaters, among
                      others. Not only that, the choices are endless as there are
                      many different models of shirts for printing. In addition, you
                      can choose unisex if you want to have your own shirts with
                      prints that suit all genders, and there are also customized
                      men's and women's shirts with different fits, not to mention
                      baby and children's shirts. When you want to print your own
                      prints on sweaters, it is most common to choose screen
                      printing, in combination with a cheap cotton sweater.
                      <br>
                      <br>
                      If you want to print on shirts made of other materials, then
                      another printing method may be more suitable - for example
                      transfer printing on polyester sweaters. When it comes to the
                      optimal size and placement of your own print on sweaters, it
                      can vary - for example, for hoodies with print when you have
                      to take into account that the back for prints on hoodies is
                      partially obscured by the hood and needs a lower print
                      placement if back print is desired.
                      <br>
                      <br>
                      In some contexts, slightly more stylish shirts with prints are
                      required for companies, then you can instead consider a shirt
                      with embroidery as marking instead of regular prints -
                      especially when it comes to printed piques.
                    </p>
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">
                    Headwear With Print
                  </button>
                </h2>
                <div id="flush-collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                    eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
                    enim ad minim veniam, quis nostrud exercitation ullamco laboris
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
                    in reprehenderit in voluptate velit esse cillum dolore eu fugiat
                    nulla pariatur. Excepteur sint occaecat cupidatat non proident,
                    sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseFour" aria-expanded="false" aria-controls="flush-collapseFour">
                    Caps With Own Print
                  </button>
                </h2>
                <div id="flush-collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                    eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
                    enim ad minim veniam, quis nostrud exercitation ullamco laboris
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
                    in reprehenderit in voluptate velit esse cillum dolore eu fugiat
                    nulla pariatur. Excepteur sint occaecat cupidatat non proident,
                    sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTweleve" aria-expanded="false" aria-controls="flush-collapseTweleve">
                    Linen with print
                  </button>
                </h2>
                <div id="flush-collapseTweleve" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                    eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
                    enim ad minim veniam, quis nostrud exercitation ullamco laboris
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
                    in reprehenderit in voluptate velit esse cillum dolore eu fugiat
                    nulla pariatur. Excepteur sint occaecat cupidatat non proident,
                    sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </div>
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12 col-md-12 col-lg-6 p-2">
        <h2>Beskrivning</h2>
        {{ description }}
      </div>
    </div>      

    <div class="gap-div-30"></div>
    <div class="row gy-2">
      <div class="col-12 col-md-12 col-lg-12">

      </div>
    </div>
    <div style="height: 50px"></div>
    {% if products %}
      <div class="articles">
        <div class="title">
          <h2>{{ text_related }}</h2>
        </div>
        <div id="carousel2" class="carousel slide">
          <div class="carousel-inner">
            {% for product in products %}
              {% if loop.index == 1 or (loop.index - 1) % 4 == 0 %}
                <div class="carousel-item {% if loop.index == 1 %}active{% endif %}">
                  <div id="product-list" class="row row-cols-1 row-cols-sm-2 row-cols-md-2 row-cols-lg-4">
              {% endif %}

                    <div class="col-6 col-md-4 col-lg-4 col-xl-3 px-2">{{ product }}</div>

              {% if loop.index % 4 == 0 or loop.last %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        <div class="slide-controls">
          <button onclick="previousSlide('carousel2')" class="slide-btn slide-btn-left"></button>
          <div class="slider-container">
            <div id="slideIndicator2" style="width: {{(1 / (products|length / 4)| round(0, 'ceil')) * 100}}%!important;"></div>
          </div>
          <button onclick="nextSlide('carousel2')" class="slide-btn slide-btn-right"></button>
        </div>
      </div>
    {% endif %}
    <div style="height: 50px"></div>
    
    {% for option in options %}
      {% if option.name == 'Print Method' %}
        <div class="search-drawer colorDrawer">
          <div class="offcanvas offcanvas-end main-drawer" style="width: 30%" tabindex="-1" id="offcanvasRight{{ option.name|replace({' ': ''}) }}" aria-labelledby="offcanvasRightLabel">
            <div class="offcanvas-header drawer_header_box pb-sm-0">
              <h2>Tryckdetaljer</h2>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="d-flex flex-column justify-content-between offcanvas-body color-main px-3 px-xl-5">
              <div id="offcanvasRightOptions{{ option.name|replace({' ': ''}) }}">
                <div class="mb-3{% if option.required %} required{% endif %}">
                  <label for="input-option-{{ option.product_option_id }}" class="form-label">{{ option.name }}</label>
                  <select class="form-select" onchange="setSelectedValue('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}', this.value); printMethodDetails(this.value)">
                    <option value="">{{ text_select }}</option>
                    {% for option_value in option.product_option_value %}
                      <option value="{{ option_value.product_option_value_id }}">{{ option_value.name }}
                        {% if option_value.price %}
                          ({{ option_value.price_prefix }}{{ option_value.price }})
                        {% endif %}</option>
                    {% endfor %}
                  </select>
                  <div id="error-option-{{ option.product_option_id }}" class="invalid-feedback"></div>
                </div>
                {% for option in options %}
                  {% if option.name == 'Print Type' or option.name == 'Print Position' %}
                    <div class="mb-3{% if option.required %} required{% endif %}">
                      <label for="input-option-{{ option.product_option_id }}" class="form-label">{{ option.name }}</label>
                      <select class="form-select"  onchange="setSelectedValue('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}', this.value)">
                        <option value="">{{ text_select }}</option>
                        {% for option_value in option.product_option_value %}
                          <option value="{{ option_value.product_option_value_id }}">{{ option_value.name }}
                            {% if option_value.price %}
                              ({{ option_value.price_prefix }}{{ option_value.price }})
                            {% endif %}</option>
                        {% endfor %}
                      </select>
                      <div id="error-option-{{ option.product_option_id }}" class="invalid-feedback"></div>
                    </div>
                  {% endif %}
                {% endfor %}
                <div class="button_div">
                  <button class="primaryButton confirm-selection-button" data-bs-dismiss="offcanvas"  onclick="confirmPrint('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}')">
                    Confirm Selection <img src="image/arrow-right.png">
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% elseif option.name == 'Print Type' %}
      {% elseif option.name == 'Print Position' %}
      {% elseif option.type == 'select' %}
        <div class="search-drawer colorDrawer">
          <div class="offcanvas offcanvas-end main-drawer" style="width: 30%" tabindex="-1" id="offcanvasRight{{ option.name|replace({' ': ''}) }}" aria-labelledby="offcanvasRightLabel">
            <div class="offcanvas-header drawer_header_box pb-sm-0">
              <h2>{{ option.name }}</h2>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="d-flex flex-column justify-content-between offcanvas-body color-main px-3 px-xl-5">
              <div id="offcanvasRightOptions{{ option.name|replace({' ': ''}) }}">

                {% for option_value in option.product_option_value %}
                <a class="" data-bs-dismiss="" onclick="setSelectedValue('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}');{% if option.name == 'Delivery Type' %} deliveryTime('{{ option.name|replace({' ': ''}) }}', 'deliverytimediv') {% endif %}">
                  <div class="color-comp choice group{{ option.name|replace({' ': ''}) }}" data-option-id="{{ option_value.product_option_value_id }}" 
                  data-option-id-price="{{ option_value.price }}"
                  onclick="markChecked(this, 'group{{ option.name|replace({' ': ''}) }}')">
                    <div class="desc">
                      <img src="{{ option_value.thumb }}">
                      <input type="hidden" id="option_value_image_{{option_value.product_option_value_id}}" src="{{option_value.image}}">
                      <h5>
                        {{ option_value.name }}
                      </h5>
                      <h5>
                      {% if option_value.price %}
                          ({{ option_value.price_prefix }}{{ option_value.price }})
                        {% endif %}
                      </h5>
                    </div>
                    <img class="check-image" src="image/check_small.svg" style="display: none;">
                  </div>
                </a>
                {% endfor %}
                
                {# <div class="button_div">
                  <button class="primaryButton confirm-selection-button" data-bs-dismiss="offcanvas"  onclick="setSelectedValue('{{ option.product_option_id }}','{{ option.name|replace({' ': ''}) }}');{% if option.name == 'Delivery Type' %} deliveryTime('{{ option.name|replace({' ': ''}) }}', 'deliverytimediv') {% endif %}">
                    Confirm Selection <img src="image/arrow-right.png">
                  </button>
                </div> #}
              </div>
            </div>
          </div>
        </div>
      {% endif %}
    {% endfor %}
    {{ content_bottom }}
  </div>
  <div class="search-drawer colorDrawer">
    <div class="offcanvas offcanvas-end main-drawer" style="width: 30%" tabindex="-1" id="offcanvasRightPrintOptions" aria-labelledby="offcanvasRightLabel">
      <div class="offcanvas-header drawer_header_box pb-sm-0">
        <h2>Tryck</h2>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="d-flex flex-column justify-content-between offcanvas-body color-main px-3 px-xl-5">
        <div >
            
        {% if attribute_groups %}
        
          {% set printTypeGroup = attribute_groups|filter(attribute_group => attribute_group.name|trim == 'Print Type')|first %}
          {% set printCodeGroup = attribute_groups|filter(attribute_group => attribute_group.name|trim == 'Print Code')|first %}

          {% if printTypeGroup and printCodeGroup %}
            {% for attribute in printTypeGroup.attribute %}
            <div class="mb-3">
              <label for="input-option-{{ attribute.name|replace({' ': ''}) }}" class="form-label">{{ attribute.name }}</label>
              <select class="form-select print_calculations" name="{{ attribute.text | lower }}_print" id="input-option-{{ attribute.name|replace({' ': ''}) }}" onchange="calculateTotalPrice()">
                <option value="Please select Print">Please Select {{ attribute.name }}</option>
                {% for attributeCode in printCodeGroup.attribute %}
                  {% for printCodeObj in printCodeJson %}
                    {% if attributeCode.name == printCodeObj.printCode %}
                      {% for amountColor in printCodeObj.amountColor %}
                        <option value="{{ attributeCode.name }}_{{ amountColor.amountColorsId }}" data-main_product="{{ product_id }}" data-product="{{ amountColor.productId }}" data-setup_product="{{ printCodeObj.productId }}">{{ printCodeObj.method }} - {{ amountColor.amountColorsName }}</option>
                      {% endfor %}
                    {% endif %}
                  {% endfor %}
                {% endfor %}
              </select>
        </div>
            {% endfor %}
          {% endif %}
          <input type="checkbox" id="notSurePrint" name="notSurePrint" value="1">  &nbsp; Osäker om tryck, hjälp mig
          <div id="price_breakup">
          </div>
          <div class="mt-2 p-2 border border-dark rounded">
          Totalt pris: <span id="total_price_breakup">0</span>
          </div>
        {% endif %}
              <div class="d-flex align-items-center justify-content-start gap-2 my-2">
                <img src="image/info.svg">
                <p style="margin: 0">
                 Tryckfiler och intrusktioner fyller du i varukorgen senare.
                </p>
              </div>
            </div>
          <div class="button_div">
            <button class="primaryButton confirm-selection-button" data-bs-dismiss="offcanvas"  onclick="setSelectedValueForPrint()">
              Bekräfta val <img src="image/arrow-right.png">
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="search-drawer">
    <div class="offcanvas offcanvas-end main-drawer" style="width: 30%" tabindex="-1" id="offcanvasRightContact" aria-labelledby="offcanvasRightLabel">
      <div class="offcanvas-header drawer_header_box">
        <h2>Kontakta oss</h2>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>

      <div class="offcanvas-body px-3 px-xl-5">
      <form id="product-query">
        <div class="contact-form-drawer">
          <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label input-label">Namn <span class="input-required">*</span></label>
            <input type="text" class="input-default" name="name" id="exampleFormControlInput1" placeholder="Ange ditt fullständiga namn">
          </div>
          <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label input-label">E-mail <span class="input-required">*</span></label>
            <input type="email" class="input-default" name="email" id="exampleFormControlInput1" placeholder="Ange din e-mail adress">
          </div>
          <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label input-label">Telefon <span class="input-required">*</span></label>
            <input type="telephone" class="input-default" name="phone" id="exampleFormControlInput1" placeholder="Ange ditt telefonnummer">
          </div>
          <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label input-label">Meddelande <span class="input-required">*</span></label>
            <textarea class="input-default" name="message" placeholder="Ditt meddelande" rows="4" style="resize: none; height: auto"></textarea>
          </div>
        </div>
        <input type="hidden" name="product_id" value={{product_id}}>
        <button type="button" style="margin: 20px 0" id="send_mail" class="primaryButton">
          Skicka <img src="image/arrow-right.png">
        </button>
        </form>
      </div>
    </div>
  </div>
  

<script type="text/javascript"><!--
$('#input-subscription').on('change', function (e) {
    var element = this;

    $('.subscription').addClass('d-none');

    $('#subscription-description-' + $(element).val()).removeClass('d-none');
});
{# $('#notSurePrint').on('click',function(){
  if($(this).is(':checked')){
      var elements = document.querySelectorAll('.print_calculations');
      // Update the numbering element (if needed)
      document.getElementById('numberingPrintOptions').innerHTML = '<img src="image/circle-tick.svg" alt="Tick">';
        
      // Add the selected option's text as a tag
      var elementToRemove = document.getElementById('tagPrintOptions').querySelector('h6');
      if (elementToRemove) {
        elementToRemove.remove();
      }

      elements.forEach(function(element, index) {
        var labelFor = element.id; // Getting the ID of the select element
        var associatedLabel = document.querySelector(`label[for="${labelFor}"]`);
        var labelText = associatedLabel.textContent;
        var selectedOptionValue = 'DG01_2';
        var selectedOptionText = 'Digital Print - Digitalprint (> 100cm2)';
        if(selectedOptionValue != 'Please select Print') {
          document.getElementById('tagPrintOptions').innerHTML += '<h6>' + labelText + ': ' + selectedOptionText + '</h6>';
        }
      });

      // You may call other functions, such as one to calculate the total price
      calculateTotalPrice();
  } else{
    numbering = document.querySelectorAll('[id^=numbering]');
    var i=0;
    numbering.forEach(function(){
      i++;
    })
    document.getElementById('numberingPrintOptions').innerHTML = i;
      var elements = document.querySelectorAll('.print_calculations');
        
      // Add the selected option's text as a tag
      var elementToRemove = document.getElementById('tagPrintOptions').querySelector('h6');
      if (elementToRemove) {
        elementToRemove.remove();
      }

      elements.forEach(function(element, index) {
        var labelFor = element.id; // Getting the ID of the select element
        var associatedLabel = document.querySelector(`label[for="${labelFor}"]`);
        var labelText = associatedLabel.textContent;
        var selectedOptionValue = element.options[element.selectedIndex].value;
        var selectedOptionText = element.options[element.selectedIndex].text;
        if(selectedOptionValue != 'Please select Print') {
          document.getElementById('tagPrintOptions').innerHTML += '<h6>' + labelText + ': ' + selectedOptionText + '</h6>';
        }
      });

      // You may call other functions, such as one to calculate the total price
      calculateTotalPrice();
  }
}); #}

$('#form-product').on('submit', async function (e) {
    e.preventDefault();

    // Define a function to handle the AJAX call
    async function makeAjaxCall(dataToSend) {
        return new Promise((resolve, reject) => {
            $.ajax({
                url: 'index.php?route=checkout/cart.add&language={{ language }}',
                type: 'post',
                data: dataToSend,
                dataType: 'json',
                contentType: 'application/x-www-form-urlencoded',
                cache: false,
                processData: false,
                success: function (json) {
                    resolve(json);
                },
                error: function (xhr, ajaxOptions, thrownError) {

                    reject(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
            });
        });
    }
    var elements = document.querySelectorAll('.print_calculations');
    var elements = document.querySelectorAll('.print_calculations');
    var group_products = 0;
    var quantity_value = 0;
    for (let element of elements) {
        var selectedValue = element.value;
        if (selectedValue !== 'Please select Print') {
            group_products = 1;
        }
    }
    $('[id^=quantity_value]').each(function(){
      var size_qty = $(this).val();
      if(size_qty != 0){
        quantity_value = parseInt(quantity_value) + parseInt(size_qty);
      }
    });
    if(quantity_value > 0){
      group_products = 1;
    }
    if($("#notSurePrint").is(':checked')){
      notSure = 1;
    }else{
      notSure = 0;
    }
    $.ajax({
        url: 'index.php?route=checkout/cart.add&language={{ language }}',
        type: 'post',
        data: $('#form-product').serialize() + '&group_products=' + group_products + '&not_sure=' + notSure,
        dataType: 'json',
        contentType: 'application/x-www-form-urlencoded',
        cache: false,
        processData: false,
        beforeSend: function () {
            $('#button-cart').button('loading');
        },
        complete: function () {
            $('#button-cart').button('reset');
        },
        success: async function (json) {

            $('#form-product').find('.is-invalid').removeClass('is-invalid');
            $('#form-product').find('.invalid-feedback').removeClass('d-block');

            if (json['error']) {
                for (key in json['error']) {
                  if(key == 'quantity') {
                    $('#error-quantity').html(json['error'][key]).addClass('d-block');
                  } else {
                    $('#input-' + key.replaceAll('_', '-')).addClass('is-invalid').find('.form-control, .form-select, .form-check-input, .form-check-label').addClass('is-invalid');
                    $('#error-' + key.replaceAll('_', '-')).html(json['error'][key]).addClass('d-block');
                  }
                    
                }
            }

            if (json['success']) {
                $('#alert').prepend('<div class="alert alert-success alert-dismissible"><i class="fa-solid fa-circle-check"></i> ' + json['success'] + ' <button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>');
                $.ajax({
                  url: 'index.php?route=checkout/cart.productsCount',
                  dataType: 'json',
                  contentType: 'application/x-www-form-urlencoded',
                  success : function(json){
                      if(json['productsCount'] >= 1){
                        if($('#lblCartCount').length){
                          $('#lblCartCount').text(json['productsCount']);
                        }else{
                          $('.cart_icon').append('<span class="badge badge-warning" id="lblCartCount">'+json['productsCount']+' </span>');
                        }
                        $('.cart_icon').attr('data-bs-original-title','Visa varukorg('+[json['productsCount']]+')');
                      }
                      $('.cart_icon').attr('data-bs-original-title','Visa varukorg('+[json['productsCount']]+')');
                  }
                });
                $('[id^=quantity_value]').each(async function(){
                  var size_qty = $(this).val();
                  if(size_qty > 0){
                        var dataProduct = $(this).attr('data-product');
                        var dataMainProduct = $(this).attr('data-main_product');

                        var product_id = dataProduct;
                        var group_product_id = dataMainProduct;
                        var quantity = size_qty;

                        // Serialize only the input elements with the name 'options[]'
                        var optionsData = $('#form-product').find('input[name^="option["][name$="]"]').serialize();
                        // Replace 'options' with 'groupoptions' in the serialized string
                        optionsData = optionsData.replace(/option%5B\d+%5D/g, function (match) {
                            return match.replace('option', 'groupoption');
                        });
                        var dataToSend1 = "product_id=" + encodeURIComponent(product_id) + "&quantity=" + encodeURIComponent(quantity) + "&product_group_id=" + encodeURIComponent(group_product_id) + "&" + optionsData + '&not_sure=' + notSure;
                        await makeAjaxCall(dataToSend1);
                  }
                });
                var elements = document.querySelectorAll('.print_calculations');
                for (let element of elements) {
                    var selectedValue = element.value;
                    if (selectedValue != 'Please select Print') {
                        var selectedOption = element.options[element.selectedIndex];
                        var dataProduct = selectedOption.getAttribute('data-product');
                        var dataMainProduct = selectedOption.getAttribute('data-main_product');
                        var dataSetupProduct = selectedOption.getAttribute('data-setup_product');

                        var product_id = dataProduct;
                        var group_product_id = dataMainProduct;
                        var setup_product_id = dataSetupProduct;
                        var quantity = document.getElementById('input-product-quantity').value;

                        // Serialize only the input elements with the name 'options[]'
                        var optionsData = $('#form-product').find('input[name^="option["][name$="]"]').serialize();
                        // Replace 'options' with 'groupoptions' in the serialized string
                        optionsData = optionsData.replace(/option%5B\d+%5D/g, function (match) {
                            return match.replace('option', 'groupoption');
                        });
                        var dataToSend1 = "product_id=" + encodeURIComponent(product_id) + "&quantity=" + encodeURIComponent(quantity) + "&product_group_id=" + encodeURIComponent(group_product_id) + "&" + optionsData + '&not_sure=' + notSure;
                        await makeAjaxCall(dataToSend1);

                        var dataToSend2 = "product_id=" + encodeURIComponent(setup_product_id) + "&quantity=" + encodeURIComponent(1) + "&product_group_id=" + encodeURIComponent(group_product_id) + "&" + optionsData + "&startup=1" + '&not_sure=' + notSure;
                        await makeAjaxCall(dataToSend2);
                    }
                }
            }
        },
        error: function (xhr, ajaxOptions, thrownError) {
            console.log(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
});


$(document).ready(function () {
  calculateTotalPrice();
    $('.magnific-popup').magnificPopup({
        type: 'image',
        delegate: 'a',
        gallery: {
            enabled: true
        }
    });
});

$("#send_mail").on('click',function(){
  $.ajax({
    url: 'index.php?route=product/product.productQuery',
    type: 'post',
    data: $('#product-query').serialize(),
    dataType: 'json',
    contentType: 'application/x-www-form-urlencoded',
    success: function (json) {
      $('#offcanvasRightContact').offcanvas('hide');
      if(json['success']){
        $('#alert').prepend('<div class="alert alert-success alert-dismissible"><i class="fa-solid fa-circle-check"></i> ' + json['success'] + ' <button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>');
      }else if(json['error']){
        $('#alert').prepend('<div class="alert alert-danger alert-dismissible"><i class="fa-solid fa-circle-check"></i> ' + json['success'] + ' <button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>');
      }
     
    },
    error: function (xhr, ajaxOptions, thrownError) {

      console.log(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
    }
  });
});

//--></script>

<script>
      let carusels = ["carousel1", "carousel2", "carousel3"];

      carusels.forEach((id) => {
        $(document).ready(function () {
          let number = id.slice(-1);
          var slideIndicator = $(`#slideIndicator${number}`);
          var carousel = $(`#${id}`);

          // Calculate the width of each slide indicator position
          var indicatorWidth = 100 / carousel.find(".carousel-item").length;

          // Set the initial position of the slide indicator
          slideIndicator.css("left", "0");

          // Listen to slide change event
          carousel.on("slide.bs.carousel", function (e) {
            var currentSlideIndex = $(e.relatedTarget).index();
            var newPosition = currentSlideIndex * indicatorWidth + "%";

            // Move the slide indicator with animation
            slideIndicator.css("left", newPosition);
          });
        });
      });

      // functions
      function nextSlide(id) {
        $(`#${id}`).carousel("next");
      }

      function previousSlide(id) {
        $(`#${id}`).carousel("prev");
      }

      function updateImage(image) {
        let index = image.src.lastIndexOf("/"),
          srcPath = image.src.slice(index, image.src.length);
        var bigImage = document.getElementById("bigImage");
        bigImage.src = image.src;
        image.classList.add("selected-image");
        let remaining = document.getElementsByClassName("selected-image");

        // removing this class from others
        for (var i = 0; i < remaining.length; i++) {
          let index1 = remaining[i].src.lastIndexOf("/"),
            path = remaining[i].src.slice(index1, remaining[i].src.length);
          if (path !== srcPath) {
            remaining[i].classList.remove("selected-image");
          }
        }
      }

      function markAsFavorite(image) {
        let index = image.src.lastIndexOf("/"),
          path = image.src.slice(index, image.src.length);
        if (path === "/wishlist1.svg") image.src = "images/wishlist.svg";
        else image.src = "images/wishlist1.svg";
      }

      // ------------ code to change range value

      // Function to handle range input change event
      function handleSizeRangeChangeNew(event, id) {
        const value = event.target.value;
        // alert("value" + value)
        const sizeValueSpan = document.querySelector(`#sizeValueQ${id}`);
        sizeValueSpan.textContent = value;

        const sizeDiv = document.querySelector(`.size-sec:nth-child(${id})`);
        const slashSeparator = sizeDiv.querySelector('.slashSeparator');
        slashSeparator.style.display = 'inline';
        calculateTotalPrice();
      }

      document.addEventListener("DOMContentLoaded", () => {
        const zoomContainer = document.querySelector(".image");
        const zoomImage = document.getElementById("bigImage");

        zoomContainer.addEventListener("mousemove", (e) => {
          const { left, top, width, height } =
            zoomContainer.getBoundingClientRect();
          const mouseX = e.clientX - left;
          const mouseY = e.clientY - top;
          const offsetX = (mouseX / width) * 100;
          const offsetY = (mouseY / height) * 100;
          zoomImage.style.transformOrigin = `${offsetX}% ${offsetY}%`;
          zoomImage.style.transform = "scale(2)";
        });

        zoomContainer.addEventListener("mouseout", () => {
          zoomImage.style.transformOrigin = "center center";
          zoomImage.style.transform = "scale(1)";
        });
      });
    </script>
{{ footer }}
<script>
$(document).ready(function() {
	$('.thumbnails').magnificPopup({
		type:'image',
		delegate: 'a',
		gallery: {
			enabled: true
		}
	});
});
$(document).ready(function(){
    $(function(){
      $(".imagesItemsResizeBtnCollapse").on("click",function(){
        console.log('your message');
        $(".imagesItemsResized").toggleClass("imagesItemsResizedBtn"),
        $(".imagesItemsResized").find("p.imagesItemsResizedShadowOverlay").toggle(),
        $(".imagesItemsResized").hasClass("imagesItemsResizedBtn")?$(".imagesItemsResizeBtnCollapse").html('Visa färre bilder <i class="fa fa-chevron-up" style="margin-left: 3px;" aria-hidden="true"></i>'):$(".imagesItemsResizeBtnCollapse").html('Visa fler bilder <i class="fa fa-chevron-down" style="margin-left: 3px;" aria-hidden="true"></i>')})
    });
});
    const wishlistForms = document.querySelectorAll('.wishlist-form');

    wishlistForms.forEach((wishlistForm) => {
        wishlistForm.addEventListener('submit', function (event) {
             event.preventDefault(); // Prevent the form submission 
            
            // Perform your AJAX request or form submission logic here

            const wishlistButton = wishlistForm.querySelector('.wishlist-button');
            const wishlistImage = wishlistButton.querySelector('img');

            const addToWishlistImage = 'image/wishlist.svg';
            const removeFromWishlistImage = 'image/wishlist1.svg';

            if (wishlistButton.contains(wishlistImage) && wishlistImage.src.includes(addToWishlistImage)) {
                // If the image is the "Add to wishlist" image, change to "Remove from wishlist" image
                wishlistImage.src = removeFromWishlistImage;
                wishlistImage.alt = 'Remove from wishlist';
                wishlistButton.title = '{{ button_remove }}';
                wishlistButton.formAction = wishlistButton.dataset.addwishlist_url;
            } else {
                // If the image is the "Remove from wishlist" image, change to "Add to wishlist" image
                wishlistImage.src = addToWishlistImage;
                wishlistImage.alt = 'Add to wishlist';
                wishlistButton.title = '{{ button_wishlist }}';
                wishlistButton.formAction = wishlistButton.dataset.remove_url;
            }
        });
    });
</script>

<script>
    function markChecked(selectedDiv, group) {
        const colorDivs = document.querySelectorAll(`.${group}`);
        var option = group.replace('group','');
        // Reset all color divs to remove the check mark
        colorDivs.forEach((div) => {
            div.classList.remove('checked');
            div.querySelector('.check-image').style.display = 'none';
        });

        // Mark the selected color div with a check mark
        selectedDiv.classList.add('checked');
        selectedDiv.querySelector('.check-image').style.display = 'block';
        $('#offcanvasRight'+option).offcanvas('hide');
        
    }

    function setSelectedValue(input, name, selectedValue = null) {
        if(selectedValue != null) {
          document.getElementById('input-option-' + input).value = selectedValue;
          document.getElementById('input-option-' + input).dataset.optionPrice = 0;
        } else {
          const checkedDiv = document.querySelector('#offcanvasRightOptions'+ name + ' .checked .desc h5');
          const selectedOptionId = checkedDiv ? checkedDiv.parentElement.parentElement.dataset.optionId : '';
          const selectedOptionIdPrice = checkedDiv ? checkedDiv.parentElement.parentElement.dataset.optionIdPrice : '';
          const selectedColorName = checkedDiv ? checkedDiv.textContent : '';

          // Set the selected color's ID to the hidden input field
          document.getElementById('input-option-' + input).value = selectedOptionId;
          document.getElementById('input-option-' + input).dataset.optionPrice = selectedOptionIdPrice;
          document.getElementById('numbering' + name).innerHTML = '<img src="image/circle-tick.svg" alt="Tick">';
          // Set the selected color's name to the hidden input field
          var elementToRemove = document.getElementById('tag' + name).querySelector('h6');
          if (elementToRemove) {
            elementToRemove.remove();
          }

          document.getElementById('tag' + name).innerHTML += '<h6>' + selectedColorName + '</h6>';
          var image_url = $('#option_value_image_'+ selectedOptionId).attr('src');
          $('#main-prod-image').attr('src',image_url)
        }
        calculateTotalPrice();
    }

    function setSelectedValueForPrint() {
      var elements = document.querySelectorAll('.print_calculations');
      // Update the numbering element (if needed)
      document.getElementById('numberingPrintOptions').innerHTML = '<img src="image/circle-tick.svg" alt="Tick">';
        
      // Add the selected option's text as a tag
      var elementToRemove = document.getElementById('tagPrintOptions').querySelector('h6');
      if (elementToRemove) {
        elementToRemove.remove();
      }

      elements.forEach(function(element, index) {
        var labelFor = element.id; // Getting the ID of the select element
        var associatedLabel = document.querySelector(`label[for="${labelFor}"]`);
        var labelText = associatedLabel.textContent;
        var selectedOptionValue = element.options[element.selectedIndex].value;
        var selectedOptionText = element.options[element.selectedIndex].text;
        if(selectedOptionValue != 'Please select Print') {
          document.getElementById('tagPrintOptions').innerHTML += '<h6>' + labelText + ': ' + selectedOptionText + '</h6>';
        }
      });

      // You may call other functions, such as one to calculate the total price
      calculateTotalPrice();
    }


    function printMethodDetails(selectedValue) {
      if (selectedValue) {
        // Hide all div elements inside the 'print_method_details' div
        const tableDisplay = document.getElementById('print_method_details');
        const allDivs = tableDisplay.querySelectorAll('div');
        allDivs.forEach(div => {
          div.style.display = 'none';
        });

        const selectedTable = document.getElementById('print_details'+selectedValue);
        if (selectedTable) {
          selectedTable.style.display = 'block';
        }
      }
    }

    function confirmPrint(input, name) {
      document.getElementById('numbering' + name).innerHTML = '<img src="image/circle-tick.svg" alt="Tick">';
    }

    function setQuantityValue(input, name, value, tag, index) {
        const checkedDiv = document.querySelector('#offcanvasRightOptions'+ name + ' .checked .desc h5');
        const selectedOptionId = checkedDiv ? checkedDiv.parentElement.parentElement.dataset.optionId : '';
        const selectedColorName = checkedDiv ? checkedDiv.textContent : '';
        var quantity = $('#quantityOne'+ index).val();
        var total_qty = $('#input-product-quantity').val();
        var total_quantity = 0;
        $('#quantity_value'+value).attr('value',quantity);
        $('[id^=quantity_value]').each(function(){
          var size_qty = $(this).val();
          if(size_qty != 0){
             total_quantity = parseInt(total_quantity) + parseInt(size_qty);
             document.getElementById('input-option-' + input + '-' +value).value = size_qty;
             //$('input[name='/'option['+ input +']['+ value +']]').attr('value',value);
          }
        });
        total_qty = parseInt(total_qty)+parseInt(quantity);

        $('#quantityOne'+ index).attr('value',quantity);
        $('#quantityOne'+ index).val(quantity);
        if(quantity == 0){
          $('#input-option-'+ input + '-'+ value).removeAttr('value');
        }else{
          $('#input-option-'+ input + '-'+ value).attr('value',quantity);
        }
          

        // Set the selected color's ID to the hidden input field
        $('#input-product-quantity').val(total_quantity);
        //$('#input-product-quantity1').val(total_quantity);
        document.getElementById('numbering' + name).innerHTML = '<img src="image/circle-tick.svg" alt="Tick">';
        // Set the selected color's name to the hidden input field
        if(quantity == 0){
          $('.option' + value).hide();
        }else{
          $('.option' + value).html(quantity + ' | ' + tag) ;
          $('.option' + value).show();
        }
        //alert('.option' + tag); 
        calculateTotalPrice();
    }


// Function to handle size selection
function selectSize(selectedIndex) {

  // Set the value of all 'quantity_input' elements to 0 except the selected one
  //const quantityInputs = document.querySelectorAll('.quantity_input');
  //quantityInputs.forEach((input, index) => {
    //if (index !== (selectedIndex - 1)) {
      //input.value = 0;
    //}
  //});

  const slashSeparators = document.querySelectorAll('.slashSeparator');

  // Hide all slash separators
  slashSeparators.forEach((separator, index) => {
    if(index != (selectedIndex-1)) {
      separator.style.display = 'none';
    }
    
  });

  const sizeDivs = document.querySelectorAll('.size-sec');

  // Hide all range inputs and remove the 'selected' class from all size divs
  sizeDivs.forEach((sizeDiv, index) => {
    const rangeInput = sizeDiv.querySelector('.single_range_input');
    sizeDiv.classList.remove('selected');
    rangeInput.style.display = 'none';

    // Check if the sizeValueElement exists before setting its text content
    if (index !== (selectedIndex - 1)) {
      const sizeValueElement = sizeDiv.querySelector(`#sizeValueQ${index + 1}`);
      if (sizeValueElement) {
        sizeValueElement.textContent = '';
      }
    }
  });

  // Show the selected size div and its corresponding range input
  const selectedSizeDiv = document.querySelector(`.size-sec:nth-child(${selectedIndex})`);
  const selectedRangeInput = selectedSizeDiv.querySelector('.single_range_input');
  selectedSizeDiv.classList.add('selected');
  selectedRangeInput.style.display = 'inline-block';
  

  // Update the hidden input field with the selected quantity value
  //const selectedQuantity = parseInt(selectedRangeInput.value, 10);
  //const inputProductQuantity = document.getElementById('input-product-quantity');
  //inputProductQuantity.value = selectedQuantity;
}

function calculateTotalPrice() {
  const quantityInput = document.getElementById('input-product-quantity');
  // Get all inputs with the name 'option[]'
  const optionInputs = document.querySelectorAll('input[name^="option["][name$="]"]');
  const basePriceInput = document.getElementById('input-base-price'); 



  // Ensure the base price is a valid number, fallback to 0 if it's not a number
  const basePriceString = basePriceInput.getAttribute('data-base-price');
  const numericBasePrice = parseFloat(basePriceString.replace(/[^0-9.-]+/g, ''));
  var basePrice = !isNaN(numericBasePrice) ? numericBasePrice : 0;

  let totalPrice = 0;

  // Loop through each input and calculate the total price
  optionInputs.forEach((input) => {
    // Get the 'data-option-price' attribute value
    const optionPrice = input.getAttribute('data-option-price');
    
    // Check if the attribute exists and contains a valid price value
    if (optionPrice && typeof optionPrice === 'string') {
      // Remove the currency symbol and convert the price to a number
      const numericPrice = parseFloat(optionPrice.replace(/[^0-9.-]+/g, ''));

      // Add the numeric price to the total price
      if (!isNaN(numericPrice)) {
        
        basePrice += numericPrice;
      }
    }

  });
  
  var quantity = parseInt(quantityInput.value);

  totalPrice = basePrice * quantity;
  var print_price = parseFloat(calculateTotalProductPrice(quantity,basePrice)).toFixed(2);
  if(print_price != 0) {
    totalPrice = print_price;
  }
  // Extract the currency symbol from the base price string
  const currencySymbol = basePriceString.replace(/[0-9.,]/g, '').trim();
  // Display the total price in the h4 element
  const totalPriceElement = document.querySelector('.total-price h4');
  totalPriceElement.textContent =  (!isNaN(totalPrice) ? totalPrice : 0)  + currencySymbol;

  // Display the total price (you can customize this based on your requirement)
  // Or you can update a specific element on the page to display the total price, e.g.:
  // document.getElementById('total-price').textContent = totalPrice;
}

function deliveryTime(name, targetDivId) {
  const checkedDiv = document.querySelector('#offcanvasRightOptions'+ name + ' .checked .desc h5');
  const selectedOptionName = checkedDiv ? checkedDiv.textContent : '';

  const targetDiv = document.getElementById(targetDivId);
  targetDiv.innerHTML = '';
  if(selectedOptionName.includes('Normal')) {
    targetDiv.innerHTML = selectedOptionName+' - Latest by <span style="font-weight: 500">15 working days ('+getWorkingDaysDate(15)+')</span>';
  } else
  {
    targetDiv.innerHTML = selectedOptionName+' - Latest by <span style="font-weight: 500">7 working days ('+getWorkingDaysDate(7)+')</span>';
  }
  // Update the text in the target div
  
  
}

function getWorkingDaysDate(daysToAdd) {
  var currentDate = new Date();
  var count = 0;

  while (count < daysToAdd) {
      currentDate.setDate(currentDate.getDate() + 1);
      if (currentDate.getDay() !== 0 && currentDate.getDay() !== 6) {
          // Increment count only if the day is not Sunday (0) or Saturday (6)
          count++;
      }
  }

  // Formatting the date to "Mon, 05 Jun 2023"
  var options = { weekday: 'short', day: '2-digit', month: 'short', year: 'numeric' };
  return currentDate.toLocaleString('en-US', options);
}

function handleSizeRangeChangeNew(event, index) {
  var rangeInput = document.getElementById('rangeOne' + index);
  var quantityInput = document.getElementById('quantityOne' + index);

  if (event.target.type === 'range') {
    quantityInput.value = rangeInput.value;
  } else if (event.target.type === 'number') {
    rangeInput.value = quantityInput.value;
  }
  var quantity = $('#quantityOne'+ index).val();
  $('#quantityOne'+ index).attr('value',quantity);
  // Your existing logic for updating the size and other UI elements
}


</script>
